# è…¾è®¯äº‘åŸŸåé…ç½®å®Œæ•´æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨è…¾è®¯äº‘ä¸Šä¸ºé å±±ç›Ÿé¡¹ç›®é…ç½®è‡ªå®šä¹‰åŸŸåï¼ŒåŒ…æ‹¬åŸŸåè´­ä¹°ã€å¤‡æ¡ˆã€è§£æã€SSL è¯ä¹¦é…ç½®ç­‰å®Œæ•´æµç¨‹ã€‚

**é…ç½®åæ•ˆæœï¼š**
- ä½¿ç”¨åŸŸåè®¿é—®ï¼š`https://yourdomain.com`
- è‡ªåŠ¨ HTTPS åŠ å¯†
- ä¸“ä¸šçš„è®¿é—®ä½“éªŒ

---

## ğŸ¯ ä¸€ã€åŸŸåå‡†å¤‡

### 1.1 åŸŸåè´­ä¹°

**åœ¨è…¾è®¯äº‘è´­ä¹°åŸŸåï¼š**

1. ç™»å½• [è…¾è®¯äº‘åŸŸåæ³¨å†Œ](https://dnspod.cloud.tencent.com/)
2. æœç´¢æƒ³è¦çš„åŸŸåï¼ˆå¦‚ï¼š`kaoshanmeng.com`ï¼‰
3. é€‰æ‹©åˆé€‚çš„åç¼€ï¼š
   - `.com` - æœ€å¸¸ç”¨ï¼Œå›½é™…é€šç”¨ï¼ˆæ¨èï¼‰
   - `.cn` - ä¸­å›½åŸŸåï¼Œéœ€è¦å®åè®¤è¯
   - `.net` - ç½‘ç»œæœåŠ¡å¸¸ç”¨
   - `.top` / `.xyz` - ä»·æ ¼ä¾¿å®œ

4. åŠ å…¥è´­ç‰©è½¦å¹¶å®Œæˆæ”¯ä»˜

**ä»·æ ¼å‚è€ƒï¼ˆ2026å¹´ï¼‰ï¼š**
- `.com` é¦–å¹´ï¼š55-65å…ƒ
- `.cn` é¦–å¹´ï¼š29-39å…ƒ
- `.top` é¦–å¹´ï¼š8-15å…ƒ

### 1.2 åŸŸåå®åè®¤è¯ï¼ˆå¿…é¡»ï¼‰

**æ­¥éª¤ï¼š**
1. è¿›å…¥ [åŸŸåç®¡ç†æ§åˆ¶å°](https://console.cloud.tencent.com/domain)
2. æ‰¾åˆ°è´­ä¹°çš„åŸŸå â†’ ç‚¹å‡»"å®åè®¤è¯"
3. æäº¤ä»¥ä¸‹ä¿¡æ¯ï¼š
   - ä¸ªäººï¼šèº«ä»½è¯æ­£åé¢ç…§ç‰‡
   - ä¼ä¸šï¼šè¥ä¸šæ‰§ç…§ + æ³•äººèº«ä»½è¯
4. ç­‰å¾…å®¡æ ¸ï¼ˆé€šå¸¸ 1-3 ä¸ªå·¥ä½œæ—¥ï¼‰

**æ³¨æ„ï¼š** æœªå®Œæˆå®åè®¤è¯çš„åŸŸåæ— æ³•è§£æï¼

### 1.3 åŸŸåå¤‡æ¡ˆï¼ˆå›½å†…æœåŠ¡å™¨å¿…é¡»ï¼‰

**ä¸ºä»€ä¹ˆéœ€è¦å¤‡æ¡ˆï¼š**
- ä½¿ç”¨å›½å†…æœåŠ¡å™¨ï¼ˆè…¾è®¯äº‘/é˜¿é‡Œäº‘ç­‰ï¼‰å¿…é¡»å¤‡æ¡ˆ
- æœªå¤‡æ¡ˆåŸŸåæ— æ³•ç»‘å®šåˆ°å›½å†…æœåŠ¡å™¨
- å¤‡æ¡ˆåæ‰èƒ½ä½¿ç”¨ 80/443 ç«¯å£

**å¤‡æ¡ˆæµç¨‹ï¼š**

1. **å‡†å¤‡ææ–™ï¼š**
   - ä¸ªäººå¤‡æ¡ˆï¼šèº«ä»½è¯ã€æ‰‹æœºå·ã€é‚®ç®±
   - ä¼ä¸šå¤‡æ¡ˆï¼šè¥ä¸šæ‰§ç…§ã€æ³•äººèº«ä»½è¯ã€å…¬ç« 

2. **æäº¤å¤‡æ¡ˆç”³è¯·ï¼š**
   - ç™»å½• [è…¾è®¯äº‘å¤‡æ¡ˆç³»ç»Ÿ](https://console.cloud.tencent.com/beian)
   - é€‰æ‹©"é¦–æ¬¡å¤‡æ¡ˆ"
   - å¡«å†™ä¸»ä½“ä¿¡æ¯ï¼ˆä¸ªäºº/ä¼ä¸šä¿¡æ¯ï¼‰
   - å¡«å†™ç½‘ç«™ä¿¡æ¯ï¼š
     - ç½‘ç«™åç§°ï¼šé å±±ç›Ÿç¤¾åŒºï¼ˆä¸èƒ½åŒ…å«æ•æ„Ÿè¯ï¼‰
     - ç½‘ç«™å†…å®¹ï¼šç¤¾äº¤ç½‘ç»œ
     - æœåŠ¡ç±»å‹ï¼šWeb åº”ç”¨

3. **ä¸Šä¼ æ ¸éªŒèµ„æ–™ï¼š**
   - ä¸Šä¼ èº«ä»½è¯/è¥ä¸šæ‰§ç…§ç…§ç‰‡
   - è¿›è¡Œäººè„¸è¯†åˆ«éªŒè¯
   - ç­¾ç½²ã€Šç½‘ç«™å¤‡æ¡ˆä¿¡æ¯çœŸå®æ€§æ ¸éªŒå•ã€‹

4. **ç­‰å¾…å®¡æ ¸ï¼š**
   - è…¾è®¯äº‘åˆå®¡ï¼š1-2 ä¸ªå·¥ä½œæ—¥
   - ç®¡å±€å®¡æ ¸ï¼š7-20 ä¸ªå·¥ä½œæ—¥
   - å¤‡æ¡ˆæˆåŠŸåä¼šæ”¶åˆ°çŸ­ä¿¡å’Œé‚®ä»¶é€šçŸ¥

**å¤‡æ¡ˆæœŸé—´æ³¨æ„äº‹é¡¹ï¼š**
- âš ï¸ å¤‡æ¡ˆæœŸé—´åŸŸåä¸èƒ½è®¿é—®
- âš ï¸ ä¿æŒæ‰‹æœºç•…é€šï¼Œå¯èƒ½ä¼šæ¥åˆ°æ ¸éªŒç”µè¯
- âš ï¸ å¤‡æ¡ˆä¿¡æ¯å¿…é¡»çœŸå®å‡†ç¡®

**å¿«é€Ÿå¤‡æ¡ˆæŠ€å·§ï¼š**
- ä½¿ç”¨è…¾è®¯äº‘å°ç¨‹åºæäº¤ï¼Œæ›´å¿«æ·
- æå‰å‡†å¤‡å¥½æ‰€æœ‰ææ–™
- ç½‘ç«™åç§°é¿å…ä½¿ç”¨ï¼šåšå®¢ã€è®ºå›ã€ç¤¾åŒºç­‰æ•æ„Ÿè¯
- å»ºè®®ä½¿ç”¨ï¼šXXä¿¡æ¯å±•ç¤ºå¹³å°ã€XXæŠ€æœ¯äº¤æµå¹³å°

---

## ğŸŒ äºŒã€åŸŸåè§£æé…ç½®

### 2.1 æ·»åŠ  DNS è§£æè®°å½•

**æ­¥éª¤ï¼š**

1. ç™»å½• [DNSPod æ§åˆ¶å°](https://console.dnspod.cn/)ï¼ˆè…¾è®¯äº‘åŸŸåé»˜è®¤ä½¿ç”¨ DNSPodï¼‰
2. æ‰¾åˆ°ä½ çš„åŸŸå â†’ ç‚¹å‡»"è§£æ"
3. æ·»åŠ ä»¥ä¸‹è®°å½•ï¼š

**è®°å½•é…ç½®ï¼š**

| è®°å½•ç±»å‹ | ä¸»æœºè®°å½• | è®°å½•å€¼ | TTL |
|---------|---------|--------|-----|
| A | @ | ä½ çš„æœåŠ¡å™¨IP | 600 |
| A | www | ä½ çš„æœåŠ¡å™¨IP | 600 |

**é…ç½®è¯´æ˜ï¼š**
- `@` è¡¨ç¤ºæ ¹åŸŸåï¼ˆå¦‚ï¼š`kaoshanmeng.com`ï¼‰
- `www` è¡¨ç¤º www å­åŸŸåï¼ˆå¦‚ï¼š`www.kaoshanmeng.com`ï¼‰
- TTL 600 è¡¨ç¤º 10 åˆ†é’Ÿç¼“å­˜

**ç¤ºä¾‹ï¼š**
```
è®°å½•ç±»å‹ï¼šA
ä¸»æœºè®°å½•ï¼š@
è®°å½•å€¼ï¼š123.456.789.100
TTLï¼š600
```

### 2.2 éªŒè¯åŸŸåè§£æ

**ç­‰å¾…è§£æç”Ÿæ•ˆï¼ˆé€šå¸¸ 5-10 åˆ†é’Ÿï¼‰ï¼š**

```bash
# åœ¨æœ¬åœ°ç”µè„‘æµ‹è¯•
ping yourdomain.com

# æŸ¥çœ‹ DNS è§£æ
nslookup yourdomain.com

# åº”è¯¥è¿”å›ä½ çš„æœåŠ¡å™¨ IP
```

**å¦‚æœè§£æä¸ç”Ÿæ•ˆï¼š**
- ç­‰å¾…æ›´é•¿æ—¶é—´ï¼ˆæœ€å¤š 24 å°æ—¶ï¼‰
- æ£€æŸ¥ DNS è®°å½•æ˜¯å¦æ­£ç¡®
- æ¸…é™¤æœ¬åœ° DNS ç¼“å­˜ï¼š
  ```bash
  # Windows
  ipconfig /flushdns

  # Mac/Linux
  sudo dscacheutil -flushcache
  ```

---

## ğŸ”’ ä¸‰ã€SSL è¯ä¹¦é…ç½®ï¼ˆHTTPSï¼‰

### 3.1 ç”³è¯·å…è´¹ SSL è¯ä¹¦

**è…¾è®¯äº‘æä¾›å…è´¹ SSL è¯ä¹¦ï¼ˆæ¨èï¼‰ï¼š**

1. ç™»å½• [SSL è¯ä¹¦æ§åˆ¶å°](https://console.cloud.tencent.com/ssl)
2. ç‚¹å‡»"ç”³è¯·å…è´¹è¯ä¹¦"
3. å¡«å†™åŸŸåä¿¡æ¯ï¼š
   - è¯ä¹¦ç±»å‹ï¼šDVï¼ˆåŸŸåéªŒè¯å‹ï¼‰
   - åŸŸåï¼š`yourdomain.com`
   - ç”³è¯·æ•°é‡ï¼š1 ä¸ª
4. é€‰æ‹©éªŒè¯æ–¹å¼ï¼š
   - **DNS éªŒè¯**ï¼ˆæ¨èï¼‰ï¼šè‡ªåŠ¨éªŒè¯ï¼Œæœ€å¿«
   - æ–‡ä»¶éªŒè¯ï¼šéœ€è¦ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
5. ç‚¹å‡»"æäº¤ç”³è¯·"

**DNS è‡ªåŠ¨éªŒè¯ï¼š**
- å¦‚æœåŸŸååœ¨è…¾è®¯äº‘ï¼Œä¼šè‡ªåŠ¨æ·»åŠ éªŒè¯è®°å½•
- ç­‰å¾… 5-10 åˆ†é’Ÿå³å¯å®ŒæˆéªŒè¯
- è¯ä¹¦ç­¾å‘åå¯ä»¥ä¸‹è½½

### 3.2 ä½¿ç”¨ Let's Encryptï¼ˆè‡ªåŠ¨ç»­æœŸï¼‰

**æ¨èä½¿ç”¨ Certbot è‡ªåŠ¨ç®¡ç†è¯ä¹¦ï¼š**

```bash
# 1. å®‰è£… Certbot
sudo apt update
sudo apt install certbot python3-certbot-nginx -y

# 2. ç”³è¯·è¯ä¹¦ï¼ˆè‡ªåŠ¨é…ç½® Nginxï¼‰
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com

# 3. æŒ‰æç¤ºè¾“å…¥é‚®ç®±
# 4. åŒæ„æœåŠ¡æ¡æ¬¾
# 5. é€‰æ‹©æ˜¯å¦é‡å®šå‘ HTTP åˆ° HTTPSï¼ˆæ¨èé€‰æ‹© 2ï¼‰

# 6. æµ‹è¯•è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

**è¯ä¹¦è‡ªåŠ¨ç»­æœŸï¼š**
```bash
# Certbot ä¼šè‡ªåŠ¨åˆ›å»ºç»­æœŸä»»åŠ¡
# æŸ¥çœ‹ç»­æœŸä»»åŠ¡
sudo systemctl list-timers | grep certbot

# æ‰‹åŠ¨ç»­æœŸ
sudo certbot renew
```

---

## ğŸ”§ å››ã€Nginx åå‘ä»£ç†é…ç½®

### 4.1 å®‰è£… Nginx

```bash
# å®‰è£… Nginx
sudo apt update
sudo apt install nginx -y

# å¯åŠ¨ Nginx
sudo systemctl start nginx
sudo systemctl enable nginx

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status nginx
```

### 4.2 é…ç½® Nginxï¼ˆHTTP + HTTPSï¼‰

**åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š**

```bash
sudo nano /etc/nginx/sites-available/kaoshanmeng
```

**é…ç½®å†…å®¹ï¼š**

```nginx
# HTTP æœåŠ¡å™¨ï¼ˆé‡å®šå‘åˆ° HTTPSï¼‰
server {
    listen 80;
    listen [::]:80;
    server_name yourdomain.com www.yourdomain.com;

    # Let's Encrypt éªŒè¯è·¯å¾„
    location /.well-known/acme-challenge/ {
        root /var/www/html;
    }

    # é‡å®šå‘åˆ° HTTPS
    location / {
        return 301 https://$server_name$request_uri;
    }
}

# HTTPS æœåŠ¡å™¨
server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name yourdomain.com www.yourdomain.com;

    # SSL è¯ä¹¦é…ç½®ï¼ˆCertbot ä¼šè‡ªåŠ¨å¡«å†™ï¼‰
    ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;

    # SSL ä¼˜åŒ–é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;

    # å®‰å…¨å¤´
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;

    # åå‘ä»£ç†åˆ° Docker å®¹å™¨
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;

        # WebSocket æ”¯æŒ
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';

        # ä»£ç†å¤´
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # ç¼“å­˜é…ç½®
        proxy_cache_bypass $http_upgrade;

        # è¶…æ—¶é…ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # é™æ€èµ„æºç¼“å­˜
    location /_next/static/ {
        proxy_pass http://localhost:3000;
        proxy_cache_valid 200 60m;
        add_header Cache-Control "public, immutable";
    }

    # æ—¥å¿—é…ç½®
    access_log /var/log/nginx/kaoshanmeng_access.log;
    error_log /var/log/nginx/kaoshanmeng_error.log;
}
```

**å¯ç”¨é…ç½®ï¼š**

```bash
# åˆ›å»ºè½¯é“¾æ¥
sudo ln -s /etc/nginx/sites-available/kaoshanmeng /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯ Nginx
sudo systemctl restart nginx
```

### 4.3 éªŒè¯ Nginx é…ç½®

```bash
# æ£€æŸ¥ Nginx çŠ¶æ€
sudo systemctl status nginx

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# æµ‹è¯•è®¿é—®
curl -I http://yourdomain.com
curl -I https://yourdomain.com
```

---

## âš™ï¸ äº”ã€åº”ç”¨é…ç½®æ›´æ–°

### 5.1 æ›´æ–°ç¯å¢ƒå˜é‡

**ç¼–è¾‘ .env.local æ–‡ä»¶ï¼š**

```bash
cd ~/kaoshanmeng
nano .env.local
```

**æ›´æ–°ä¸ºåŸŸåï¼š**

```bash
# Supabase é…ç½®
NEXT_PUBLIC_SUPABASE_URL=https://ä½ çš„é¡¹ç›®ID.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=ä½ çš„SupabaseåŒ¿åå¯†é’¥

# â­ æ›´æ–°ä¸ºä½ çš„åŸŸå
NEXT_PUBLIC_APP_URL=https://yourdomain.com

# è®¿é—®æ§åˆ¶ï¼ˆå¯é€‰ï¼‰
GATE_PASSWORD=your-secure-password
```

### 5.2 æ›´æ–° Dockerfileï¼ˆå¦‚æœç¡¬ç¼–ç äº†ç¯å¢ƒå˜é‡ï¼‰

**ç¼–è¾‘ Dockerfileï¼š**

```bash
nano Dockerfile
```

**æ‰¾åˆ°ç¯å¢ƒå˜é‡éƒ¨åˆ†å¹¶æ›´æ–°ï¼š**

```dockerfile
# â­ æ›´æ–°ä¸ºä½ çš„åŸŸå
ENV NEXT_PUBLIC_APP_URL=https://yourdomain.com
```

### 5.3 é‡æ–°æ„å»ºå’Œéƒ¨ç½²

```bash
# åœæ­¢å®¹å™¨
docker compose down

# é‡æ–°æ„å»ºï¼ˆä½¿ç”¨æ–°çš„ç¯å¢ƒå˜é‡ï¼‰
docker compose build --no-cache

# å¯åŠ¨å®¹å™¨
docker compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f
```

---

## ğŸ—„ï¸ å…­ã€Supabase é…ç½®æ›´æ–°

### 6.1 æ›´æ–° Site URL

**æ­¥éª¤ï¼š**

1. ç™»å½• [Supabase Dashboard](https://supabase.com/dashboard)
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. è¿›å…¥ **Authentication** â†’ **URL Configuration**
4. æ›´æ–°ä»¥ä¸‹é…ç½®ï¼š

**Site URLï¼š**
```
https://yourdomain.com
```

**Redirect URLsï¼ˆæ·»åŠ ä»¥ä¸‹ URLï¼‰ï¼š**
```
https://yourdomain.com/**
https://yourdomain.com/auth/callback
https://yourdomain.com/auth/confirm
```

### 6.2 æ›´æ–°é‚®ä»¶æ¨¡æ¿ï¼ˆå¯é€‰ï¼‰

**å¦‚æœå¯ç”¨äº†é‚®ç®±éªŒè¯ï¼š**

1. è¿›å…¥ **Authentication** â†’ **Email Templates**
2. æ›´æ–° **Confirm signup** æ¨¡æ¿
3. ç¡®ä¿é“¾æ¥ä½¿ç”¨æ–°åŸŸåï¼š
   ```
   {{ .SiteURL }}/auth/confirm?token_hash={{ .TokenHash }}&type=email
   ```

### 6.3 æµ‹è¯•è®¤è¯æµç¨‹

```bash
# 1. è®¿é—®æ³¨å†Œé¡µé¢
https://yourdomain.com/register

# 2. æ³¨å†Œæ–°ç”¨æˆ·
# 3. æ£€æŸ¥é‚®ç®±éªŒè¯é“¾æ¥æ˜¯å¦æ­£ç¡®
# 4. æµ‹è¯•ç™»å½•åŠŸèƒ½
```

---

## âœ… ä¸ƒã€éƒ¨ç½²éªŒè¯æ¸…å•

### 7.1 åŸŸåå’Œ DNS éªŒè¯

- [ ] åŸŸåå·²è´­ä¹°å¹¶å®åè®¤è¯
- [ ] åŸŸåå·²å®Œæˆå¤‡æ¡ˆï¼ˆå›½å†…æœåŠ¡å™¨ï¼‰
- [ ] DNS è§£æå·²é…ç½®ï¼ˆA è®°å½•ï¼‰
- [ ] åŸŸåå¯ä»¥ ping é€š
- [ ] nslookup è¿”å›æ­£ç¡® IP

### 7.2 SSL è¯ä¹¦éªŒè¯

- [ ] SSL è¯ä¹¦å·²ç”³è¯·
- [ ] è¯ä¹¦å·²å®‰è£…åˆ° Nginx
- [ ] HTTPS å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] HTTP è‡ªåŠ¨é‡å®šå‘åˆ° HTTPS
- [ ] æµè§ˆå™¨æ˜¾ç¤ºå®‰å…¨é”å›¾æ ‡

### 7.3 åº”ç”¨é…ç½®éªŒè¯

- [ ] .env.local å·²æ›´æ–°ä¸ºåŸŸå
- [ ] Docker å®¹å™¨å·²é‡æ–°æ„å»º
- [ ] åº”ç”¨å¯ä»¥é€šè¿‡åŸŸåè®¿é—®
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸
- [ ] API è¯·æ±‚æ­£å¸¸

### 7.4 Supabase é…ç½®éªŒè¯

- [ ] Site URL å·²æ›´æ–°ä¸ºåŸŸå
- [ ] Redirect URLs å·²æ·»åŠ 
- [ ] æ³¨å†ŒåŠŸèƒ½æ­£å¸¸
- [ ] ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] é‚®ç®±éªŒè¯é“¾æ¥æ­£ç¡®ï¼ˆå¦‚æœå¯ç”¨ï¼‰

---

## ğŸ” å…«ã€å¸¸è§é—®é¢˜æ’æŸ¥

### 8.1 åŸŸåæ— æ³•è®¿é—®

**å¯èƒ½åŸå› ï¼š**
1. DNS è§£ææœªç”Ÿæ•ˆï¼ˆç­‰å¾… 10 åˆ†é’Ÿåˆ° 24 å°æ—¶ï¼‰
2. é˜²ç«å¢™æœªå¼€æ”¾ 80/443 ç«¯å£
3. Nginx æœªå¯åŠ¨
4. åŸŸåæœªå¤‡æ¡ˆï¼ˆå›½å†…æœåŠ¡å™¨ï¼‰

**æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥ DNS è§£æ
nslookup yourdomain.com

# 2. æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# 3. æ£€æŸ¥ Nginx çŠ¶æ€
sudo systemctl status nginx

# 4. æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep -E '80|443'

# 5. æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### 8.2 SSL è¯ä¹¦é”™è¯¯

**é—®é¢˜ç°è±¡ï¼š**
- æµè§ˆå™¨æç¤º"ä¸å®‰å…¨"
- è¯ä¹¦è¿‡æœŸ
- è¯ä¹¦åŸŸåä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆï¼š**

```bash
# 1. æ£€æŸ¥è¯ä¹¦çŠ¶æ€
sudo certbot certificates

# 2. é‡æ–°ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d yourdomain.com --force-renewal

# 3. æ£€æŸ¥ Nginx é…ç½®
sudo nginx -t

# 4. é‡å¯ Nginx
sudo systemctl restart nginx
```

### 8.3 502 Bad Gateway

**å¯èƒ½åŸå› ï¼š**
- Docker å®¹å™¨æœªå¯åŠ¨
- ç«¯å£é…ç½®é”™è¯¯
- åº”ç”¨å¯åŠ¨å¤±è´¥

**æ’æŸ¥æ­¥éª¤ï¼š**

```bash
# 1. æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker compose ps

# 2. æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker compose logs -f

# 3. æ£€æŸ¥ç«¯å£æ˜ å°„
docker compose ps

# 4. æµ‹è¯•æœ¬åœ°è®¿é—®
curl http://localhost:3000

# 5. é‡å¯å®¹å™¨
docker compose restart
```

### 8.4 é‚®ç®±éªŒè¯é“¾æ¥é”™è¯¯

**é—®é¢˜ï¼š** é‚®ä»¶ä¸­çš„é“¾æ¥ä»ç„¶æ˜¯æ—§çš„ IP åœ°å€

**è§£å†³æ–¹æ¡ˆï¼š**

1. ç¡®è®¤ Supabase Site URL å·²æ›´æ–°
2. ç¡®è®¤ .env.local ä¸­çš„ `NEXT_PUBLIC_APP_URL` å·²æ›´æ–°
3. é‡æ–°æ„å»º Docker é•œåƒ
4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
5. é‡æ–°æ³¨å†Œæµ‹è¯•

---

## ğŸ“Š ä¹ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 9.1 å¯ç”¨ Gzip å‹ç¼©

**ç¼–è¾‘ Nginx é…ç½®ï¼š**

```nginx
# åœ¨ http å—ä¸­æ·»åŠ 
gzip on;
gzip_vary on;
gzip_proxied any;
gzip_comp_level 6;
gzip_types text/plain text/css text/xml text/javascript
           application/json application/javascript application/xml+rss
           application/rss+xml font/truetype font/opentype
           application/vnd.ms-fontobject image/svg+xml;
```

### 9.2 é…ç½® CDN åŠ é€Ÿï¼ˆå¯é€‰ï¼‰

**è…¾è®¯äº‘ CDNï¼š**

1. ç™»å½• [CDN æ§åˆ¶å°](https://console.cloud.tencent.com/cdn)
2. æ·»åŠ åŸŸå
3. é…ç½®æºç«™ï¼šä½ çš„æœåŠ¡å™¨ IP
4. é…ç½® HTTPS è¯ä¹¦
5. æ›´æ–° DNS è§£æä¸º CDN æä¾›çš„ CNAME

### 9.3 å¯ç”¨ HTTP/2

**Nginx é…ç½®å·²åŒ…å«ï¼š**
```nginx
listen 443 ssl http2;
```

**éªŒè¯ HTTP/2ï¼š**
```bash
curl -I --http2 https://yourdomain.com
```

---

## ğŸ”„ åã€åŸŸåæ›´æ¢æµç¨‹

**å¦‚æœéœ€è¦æ›´æ¢åŸŸåï¼š**

1. **è´­ä¹°æ–°åŸŸåå¹¶å®Œæˆå¤‡æ¡ˆ**
2. **é…ç½® DNS è§£æ**
3. **ç”³è¯· SSL è¯ä¹¦**
4. **æ›´æ–° Nginx é…ç½®**
5. **æ›´æ–°åº”ç”¨ç¯å¢ƒå˜é‡**
6. **æ›´æ–° Supabase é…ç½®**
7. **é‡æ–°æ„å»ºéƒ¨ç½²**

**è¯¦ç»†æ­¥éª¤å‚è€ƒï¼š** [DOMAIN_CHANGE_GUIDE.md](DOMAIN_CHANGE_GUIDE.md)

---

## ğŸ“ åä¸€ã€ç»´æŠ¤å»ºè®®

### 11.1 å®šæœŸæ£€æŸ¥

```bash
# æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡
# 1. SSL è¯ä¹¦æœ‰æ•ˆæœŸ
sudo certbot certificates

# 2. åŸŸåè§£æçŠ¶æ€
nslookup yourdomain.com

# 3. Nginx æ—¥å¿—
sudo tail -100 /var/log/nginx/error.log

# 4. åº”ç”¨çŠ¶æ€
docker compose ps
```

### 11.2 ç›‘æ§è„šæœ¬

```bash
# åˆ›å»ºç›‘æ§è„šæœ¬
nano ~/monitor-domain.sh
```

**è„šæœ¬å†…å®¹ï¼š**

```bash
#!/bin/bash

echo "=== åŸŸåå’ŒæœåŠ¡ç›‘æ§ ==="
echo ""

# 1. æ£€æŸ¥åŸŸåè§£æ
echo "1. åŸŸåè§£æï¼š"
nslookup yourdomain.com | grep Address

# 2. æ£€æŸ¥ SSL è¯ä¹¦
echo ""
echo "2. SSL è¯ä¹¦çŠ¶æ€ï¼š"
sudo certbot certificates | grep -E "Certificate Name|Expiry Date"

# 3. æ£€æŸ¥ Nginx çŠ¶æ€
echo ""
echo "3. Nginx çŠ¶æ€ï¼š"
sudo systemctl status nginx | grep Active

# 4. æ£€æŸ¥åº”ç”¨çŠ¶æ€
echo ""
echo "4. åº”ç”¨å®¹å™¨çŠ¶æ€ï¼š"
docker compose ps

# 5. æµ‹è¯• HTTPS è®¿é—®
echo ""
echo "5. HTTPS è®¿é—®æµ‹è¯•ï¼š"
curl -I -s https://yourdomain.com | head -1

echo ""
echo "=== ç›‘æ§å®Œæˆ ==="
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
chmod +x ~/monitor-domain.sh
./monitor-domain.sh
```

---

## ğŸ“ åäºŒã€æœ€ä½³å®è·µ

### 12.1 åŸŸåé€‰æ‹©å»ºè®®

- âœ… é€‰æ‹© `.com` åŸŸåï¼ˆæœ€é€šç”¨ï¼‰
- âœ… åŸŸåç®€çŸ­æ˜“è®°
- âœ… é¿å…ä½¿ç”¨æ•°å­—å’Œè¿å­—ç¬¦
- âœ… æå‰æ£€æŸ¥åŸŸåæ˜¯å¦è¢«å¢™

### 12.2 å®‰å…¨å»ºè®®

- âœ… å§‹ç»ˆä½¿ç”¨ HTTPS
- âœ… å®šæœŸæ›´æ–° SSL è¯ä¹¦
- âœ… é…ç½®å®‰å…¨å“åº”å¤´
- âœ… å¯ç”¨ HSTS
- âœ… å®šæœŸå¤‡ä»½é…ç½®

### 12.3 SEO ä¼˜åŒ–

- âœ… é…ç½® www é‡å®šå‘
- âœ… å¯ç”¨ HTTP/2
- âœ… é…ç½® robots.txt
- âœ… æ·»åŠ  sitemap.xml

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å›½å†…æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—](DEPLOYMENT_CHINA.md)
- [æ›´æ¢åŸŸåæ“ä½œæŒ‡å—](DOMAIN_CHANGE_GUIDE.md)
- [Nginx é…ç½®ä¼˜åŒ–](NGINX_OPTIMIZATION.md)
- [SSL è¯ä¹¦ç®¡ç†](SSL_CERTIFICATE_GUIDE.md)

---

## ğŸ†˜ è·å–å¸®åŠ©

**é‡åˆ°é—®é¢˜æ—¶ï¼š**

1. æ£€æŸ¥åŸŸåå¤‡æ¡ˆçŠ¶æ€
2. éªŒè¯ DNS è§£æ
3. æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—
4. æ£€æŸ¥é˜²ç«å¢™é…ç½®
5. æµ‹è¯•æœ¬åœ°è®¿é—®

**å¸¸ç”¨è¯Šæ–­å‘½ä»¤ï¼š**

```bash
# å®Œæ•´è¯Šæ–­
nslookup yourdomain.com
ping yourdomain.com
curl -I https://yourdomain.com
sudo nginx -t
sudo systemctl status nginx
docker compose ps
docker compose logs --tail=50
```

---

**æœ€åæ›´æ–°ï¼š** 2026-02-08
**é€‚ç”¨ç‰ˆæœ¬ï¼š** v1.0+
**ç»´æŠ¤è€…ï¼š** é å±±ç›Ÿå›¢é˜Ÿ
